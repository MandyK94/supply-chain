services:

  build-stage:
    build:
      context: ..
      dockerfile: deploy/Dockerfile.build

  gateway:
    build:
      context: ..
      dockerfile: gateway/Dockerfile
    depends_on:
      - build-stage
    ports:
      - "8080:8080"

  identity-service:
    build:
      context: ..
      dockerfile: identity-service/Dockerfile
    depends_on:
      - build-stage

  registry-service:
    build:
      context: ..
      dockerfile: registry-service/Dockerfile
    depends_on:
      - build-stage

  lot-service:
    build:
      context: ..
      dockerfile: lot-service/Dockerfile
    depends_on:
      - build-stage

  transfer-service:
    build:
      context: ..
      dockerfile: transfer-service/Dockerfile
    depends_on:
      - build-stage

  audit-service:
    build:
      context: ..
      dockerfile: audit-service/Dockerfile
    depends_on:
      - build-stage

  consumer-api:
    build:
      context: ..
      dockerfile: consumer-api/Dockerfile
    depends_on:
      - build-stage

  legacy-adapter:
    build:
      context: ..
      dockerfile: legacy-adapter/Dockerfile
    depends_on:
      - build-stage

  analytics-service:
    build:
      context: ..
      dockerfile: analytics-service/Dockerfile
    depends_on:
      - build-stage

  frontend:
    build:
      context: ../frontend
      dockerfile: Dockerfile
    ports:
      - "3000:80"

